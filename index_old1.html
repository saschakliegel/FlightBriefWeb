
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>FlightBrief Web</title>
  <style>
    /* --- Base --- */
    body { font-family: sans-serif; margin:0; padding:0; }
    nav { display:flex; background:#333; }
    nav button {
      flex:1; padding:1em; border:none;
      color:#fff; background:#333; cursor:pointer;
    }
    nav button.active { background:#555; }
    section { padding:1em; }
    h2 { margin-top:0; }
    details { margin:0.5em 0; }

    /* --- Legend Bar --- */
    #legend {
      display: flex;
      margin: 0 1em 1em;
      padding: 0.5em;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    #legend div {
      flex: 1;
      text-align: center;
      padding: 0.5em;
      font-size: 0.9em;
      border-radius: 4px;
      color: #000;
    }
    /* Colour swatches (solid) */
    #legend .cat-D  { background: #008000; color: #fff; }
    #legend .cat-A1 { background: #80FF00; }
    #legend .cat-A2 { background: #FFFF00; }
    #legend .cat-CA { background: #FFA500; }
    #legend .cat-EA { background: #FF0000; color: #fff; }

    /* --- List items --- */
    .airport, .border {
      margin-bottom:1em;
      padding:0.5em;
      border-radius:4px;
    }
    /* Tinted backgrounds for airports */
    /* Exact legend colours */
    .airport.cat-D  { background: #008000; color: #fff; }
    .airport.cat-A1 { background: #80FF00; }
    .airport.cat-A2 { background: #FFFF00; }
    .airport.cat-CA { background: #FFA500; }
    .airport.cat-EA { background: #FF0000; color: #fff; }


    /* Border entries */
    .border { background:rgba(0,0,128,0.1); }
  </style>
</head>
<body>
  <nav>
    <button id="airports-tab" class="active">Airports</button>
    <button id="borders-tab">Borders</button>
  </nav>

  <!-- ===== AIRPORTS ===== -->
  <section id="airports-section">
    <h2>Airports</h2>

    <!-- Legend bar -->
    <div id="legend">
      <div class="cat-D">D<br/><small>Destination</small></div>
      <div class="cat-A1">A1<br/><small>Fully Capable Alternate</small></div>
      <div class="cat-A2">A2<br/><small>Fuel &amp; Go / Planning Alternate</small></div>
      <div class="cat-CA">CA<br/><small>Critical Aerodrome</small></div>
      <div class="cat-EA">EA<br/><small>Emergency Aerodrome</small></div>
    </div>

    <!-- Definitions -->
    <details>
      <summary><strong>Legend Definitions &amp; Notes</strong></summary>
      <p><strong>Destination Aerodrome (D):</strong> an aerodrome served by an Emirates scheduled flight and designated as available for such use in the Operations Specifications.</p>
      <p><strong>“Fully Capable Alternate” [A1]:</strong> an alternate aerodrome which has all ground‐handling capabilities (as approved by EK Aerodrome Services) and limited engineering capabilities with certified staff. (Captain release or one‐off engineering provision required.)</p>
      <p><strong>“Fuel &amp; Go” / “Planning Alternate” [A2]:</strong> an alternate with limited ground‐handling/engineering (parking, customs/immigration, etc.), but can be refuelled and re‐dispatched with pax/cargo on board.</p>
      <p><strong>Critical Aerodrome (CA):</strong> an aerodrome to which diversion can be accomplished primarily for ETOPS support and depressurisation strategies.</p>
      <p><strong>Emergency Aerodrome (EA):</strong> aerodromes not meeting the above categories, listed only for certain routes when coverage is sparse. <em>Use only in dire emergencies.</em></p>
      <p><em>Note:</em> D/A1/A2/CA are considered “adequate” for ETOPS/Drift-down &amp; Depressurisation (Ops Specs Note 1); CAs are <em>not</em> recommended for medical diversion due to limited support (Ops Specs Note 2).</p>
    </details>

    <!-- Container where JS will inject airport entries -->
    <div id="airports-container">Loading…</div>
  </section>


  <!-- ===== BORDERS ===== -->
  <section id="borders-section" style="display:none">
    <h2>Borders</h2>
    <div id="borders-container">Loading…</div>
  </section>


  <script>
    // Tab switching
    document.getElementById('airports-tab').onclick = () => {
      document.getElementById('airports-section').style.display = '';
      document.getElementById('borders-section').style.display = 'none';
      document.getElementById('airports-tab').classList.add('active');
      document.getElementById('borders-tab').classList.remove('active');
    };
    document.getElementById('borders-tab').onclick = () => {
      document.getElementById('airports-section').style.display = 'none';
      document.getElementById('borders-section').style.display = '';
      document.getElementById('borders-tab').classList.add('active');
      document.getElementById('airports-tab').classList.remove('active');
    };

    // Load and render airports.json
    async function loadAirports() {
      try {
        const res = await fetch('airports.json');
        const airports = await res.json();
        const container = document.getElementById('airports-container');
        container.innerHTML = '';
        airports
          .sort((a,b)=> (a.ICAO||'').localeCompare(b.ICAO||''))
          .forEach(a => {
            const div = document.createElement('div');
            // pick the category code letter from Class/AIRFIELD CAT/RFF, e.g. "A1"
            const cat = (a["Class/AIRFIELD CAT/RFF"]||'').match(/^[A-Z0-9]+/)?.[0] || 'D';
            div.className = `airport cat-${cat}`;
            div.innerHTML = `
              <strong>${a.ICAO} — ${a.Name||''}</strong><br/>
              IATA: ${a.IATA||'–'} • Elev: ${a.Elevation||'–'}<br/>
              Category: ${a["Class/AIRFIELD CAT/RFF"]||'–'}<br/>
              Rwy: ${a.Rwy||'–'}<br/>
              Approach: ${a.Approach||'–'}<br/>
              CCI: ${a.CCI||'–'}<br/>
              OPS HRS: ${a["OPS HRS (ATC/ADMIN)"]||'–'}<br/>
              NOTAM: ${a.NOTAM||'–'}
            `;
            container.appendChild(div);
          });
      } catch(err) {
        console.error(err);
        document.getElementById('airports-container').textContent = 'Failed to load airports.';
      }
    }

    // Load and render borders_cleaned.json
    async function loadBorders() {
      try {
        const res = await fetch('borders_cleaned.json');
        const borders = await res.json();
        const container = document.getElementById('borders-container');
        container.innerHTML = '';
        borders.forEach(b => {
          const div = document.createElement('div');
          div.className = 'border';
          div.innerHTML = `
            <strong>${b.waypoint}</strong><br/>
            FIR: ${b.fir}<br/>
            <details>
              <summary>Notes</summary>
              <p><strong>Requirement:</strong> ${b.notes.requirement}</p>
              <p><strong>Frequency:</strong> ${b.notes.frequency.replace(/\n/g,'<br/>')}</p>
              ${b.notes.other
                ? `<p><strong>Other:</strong> ${b.notes.other.replace(/\n/g,'<br/>')}</p>`
                : ''
              }
            </details>
          `;
          container.appendChild(div);
        });
      } catch(err) {
        console.error(err);
        document.getElementById('borders-container').textContent = 'Failed to load borders.';
      }
    }

    // Kick off both on page load
    window.addEventListener('DOMContentLoaded', () => {
      loadAirports();
      loadBorders();
    });
  </script>
</body>
</html>
